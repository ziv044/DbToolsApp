# Story 1.7: Tenant Management UI

## Status: Draft

## Story

**As an** operator,
**I want** a simple UI to manage tenants,
**so that** I can onboard customers easily.

## Acceptance Criteria

| # | Criteria |
|---|----------|
| 1 | Admin page accessible via `/admin/tenants` route |
| 2 | Tenant list table: name, slug, status, created date, actions |
| 3 | "Create Tenant" button opens modal with: name, slug fields |
| 4 | Form validates slug format before submission |
| 5 | Success toast notification after tenant creation |
| 6 | Refresh tenant list after creation |
| 7 | Suspend/Activate toggle button per tenant row |
| 8 | Delete button with confirmation dialog (soft delete) |

## Tasks / Subtasks

- [ ] Task 1: Create admin route and page (AC: 1)
  - [ ] Add `/admin/tenants` route to App.tsx
  - [ ] Create `src/pages/admin/Tenants.tsx`
  - [ ] Add admin navigation or direct URL access

- [ ] Task 2: Create tenant list table (AC: 2)
  - [ ] Create `src/components/admin/TenantList.tsx`
  - [ ] Display name, slug, status, created_at
  - [ ] Add action buttons column
  - [ ] Use shadcn Table component

- [ ] Task 3: Create tenant form modal (AC: 3, 4)
  - [ ] Create `src/components/admin/TenantForm.tsx`
  - [ ] Add name and slug input fields
  - [ ] Add slug format validation (alphanumeric + hyphens)
  - [ ] Auto-generate slug from name option
  - [ ] Use shadcn Dialog component

- [ ] Task 4: Implement create tenant flow (AC: 5, 6)
  - [ ] Create `src/services/tenantService.ts`
  - [ ] Add useMutation for tenant creation
  - [ ] Show success toast on creation
  - [ ] Invalidate tenant list query

- [ ] Task 5: Implement tenant actions (AC: 7, 8)
  - [ ] Add Suspend/Activate toggle
  - [ ] Add Delete button with confirmation
  - [ ] Use shadcn AlertDialog for confirmation
  - [ ] Implement PATCH for status change
  - [ ] Implement DELETE for soft delete

## Dev Notes

### Tenant Service
```typescript
// src/services/tenantService.ts
import { apiClient } from './api';

export interface Tenant {
  id: string;
  name: string;
  slug: string;
  status: 'active' | 'suspended';
  created_at: string;
}

export const tenantService = {
  getAll: async (): Promise<Tenant[]> => {
    const { data } = await apiClient.get('/tenants');
    return data;
  },

  create: async (input: { name: string; slug: string }): Promise<Tenant> => {
    const { data } = await apiClient.post('/tenants', input);
    return data;
  },

  updateStatus: async (slug: string, status: string): Promise<Tenant> => {
    const { data } = await apiClient.patch(`/tenants/${slug}`, { status });
    return data;
  },

  delete: async (slug: string): Promise<void> => {
    await apiClient.delete(`/tenants/${slug}`);
  },
};
```

### Slug Validation
```typescript
const SLUG_REGEX = /^[a-z0-9][a-z0-9-]{1,48}[a-z0-9]$/;

const validateSlug = (slug: string): boolean => {
  return SLUG_REGEX.test(slug);
};

const generateSlug = (name: string): string => {
  return name
    .toLowerCase()
    .replace(/[^a-z0-9]+/g, '-')
    .replace(/^-|-$/g, '')
    .slice(0, 50);
};
```

### Toast Notifications
```typescript
// Using shadcn toast
import { toast } from '@/components/ui/use-toast';

toast({
  title: 'Tenant created',
  description: `${tenant.name} has been created successfully.`,
});
```

## Testing

### Test Requirements
- Test tenant list displays correctly
- Test create modal opens and validates
- Test tenant creation flow
- Test suspend/activate toggle
- Test delete with confirmation
- Location: `frontend/tests/components/`

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-17 | 0.1 | Initial story creation | PM (John) |

---

## Dev Agent Record

### Agent Model Used
(To be filled by dev agent)

### Debug Log References
(To be filled by dev agent)

### Completion Notes List
(To be filled by dev agent)

### File List
(To be filled by dev agent)

---

## QA Results
(To be filled by QA agent)
