# Story 1.6: React Application Shell

## Status: Draft

## Story

**As a** user,
**I want** a basic application layout with navigation,
**so that** I can access different features of the platform.

## Acceptance Criteria

| # | Criteria |
|---|----------|
| 1 | Application shell with sidebar navigation |
| 2 | Header with tenant selector dropdown (fetches from `/api/tenants`) |
| 3 | Selecting tenant stores choice in localStorage and sets header for all API calls |
| 4 | Sidebar menu items: Dashboard, Servers, Groups, Policies, Jobs, Settings (placeholders) |
| 5 | Main content area with React Router outlet |
| 6 | Dashboard page shows "Welcome to {tenant_name}" placeholder |
| 7 | Responsive layout functional on 1280px+ screens |
| 8 | Loading spinner while tenant list loads |
| 9 | Error state if API unavailable |

## Tasks / Subtasks

- [ ] Task 1: Setup React Router and base structure (AC: 5)
  - [ ] Install react-router-dom
  - [ ] Create `src/App.tsx` with router setup
  - [ ] Create `src/pages/` folder
  - [ ] Create placeholder page components

- [ ] Task 2: Install and configure UI libraries (AC: 1, 7)
  - [ ] Install Tailwind CSS
  - [ ] Install shadcn/ui dependencies
  - [ ] Configure tailwind.config.js
  - [ ] Add base shadcn components (Button, Card, Select)

- [ ] Task 3: Create layout components (AC: 1, 4)
  - [ ] Create `src/components/layout/MainLayout.tsx`
  - [ ] Create `src/components/layout/Sidebar.tsx`
  - [ ] Create `src/components/layout/Header.tsx`
  - [ ] Add navigation menu items

- [ ] Task 4: Create API client with tenant header (AC: 3)
  - [ ] Install axios
  - [ ] Create `src/services/api.ts` with axios instance
  - [ ] Add tenant header interceptor
  - [ ] Create `src/stores/tenantStore.ts` with Zustand

- [ ] Task 5: Create tenant selector (AC: 2, 3, 8, 9)
  - [ ] Install @tanstack/react-query and zustand
  - [ ] Create `src/hooks/useTenants.ts`
  - [ ] Create tenant selector dropdown in Header
  - [ ] Handle loading and error states

- [ ] Task 6: Create Dashboard page (AC: 6)
  - [ ] Create `src/pages/Dashboard.tsx`
  - [ ] Display "Welcome to {tenant_name}"
  - [ ] Show placeholder content

## Dev Notes

### Package Dependencies
```json
{
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.20.0",
    "@tanstack/react-query": "^5.0.0",
    "zustand": "^4.4.0",
    "axios": "^1.6.0",
    "tailwindcss": "^3.3.0",
    "lucide-react": "^0.294.0"
  }
}
```

### Tenant Store
```typescript
// src/stores/tenantStore.ts
import { create } from 'zustand';
import { persist } from 'zustand/middleware';

interface TenantState {
  currentTenant: string | null;
  setTenant: (slug: string) => void;
  clearTenant: () => void;
}

export const useTenantStore = create<TenantState>()(
  persist(
    (set) => ({
      currentTenant: null,
      setTenant: (slug) => set({ currentTenant: slug }),
      clearTenant: () => set({ currentTenant: null }),
    }),
    { name: 'dbtools-tenant' }
  )
);
```

### API Client with Tenant Header
```typescript
// src/services/api.ts
import axios from 'axios';
import { useTenantStore } from '../stores/tenantStore';

export const apiClient = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL || 'http://localhost:5000/api',
});

apiClient.interceptors.request.use((config) => {
  const tenant = useTenantStore.getState().currentTenant;
  if (tenant) {
    config.headers['X-Tenant-Slug'] = tenant;
  }
  return config;
});
```

### Route Structure
```typescript
// src/App.tsx
<Routes>
  <Route path="/" element={<MainLayout />}>
    <Route index element={<Navigate to="/dashboard" />} />
    <Route path="dashboard" element={<Dashboard />} />
    <Route path="servers" element={<Servers />} />
    <Route path="groups" element={<Groups />} />
    <Route path="policies" element={<Policies />} />
    <Route path="jobs" element={<Jobs />} />
    <Route path="alerts" element={<Alerts />} />
  </Route>
</Routes>
```

## Testing

### Test Requirements
- Test tenant selector loads tenants
- Test tenant selection persists to localStorage
- Test API calls include X-Tenant-Slug header
- Location: `frontend/tests/`

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-17 | 0.1 | Initial story creation | PM (John) |

---

## Dev Agent Record

### Agent Model Used
(To be filled by dev agent)

### Debug Log References
(To be filled by dev agent)

### Completion Notes List
(To be filled by dev agent)

### File List
(To be filled by dev agent)

---

## QA Results
(To be filled by QA agent)
