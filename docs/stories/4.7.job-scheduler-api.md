# Story 4.7: Job Scheduler API

## Status: Draft

## Story

**As a** user,
**I want** to manage scheduled jobs via API,
**so that** I can create, modify, and monitor automation.

## Acceptance Criteria

| # | Criteria |
|---|----------|
| 1 | `POST /api/jobs` creates new scheduled job |
| 2 | `GET /api/jobs` returns all jobs with next_run_at and status |
| 3 | `GET /api/jobs/{id}` returns job with recent execution history |
| 4 | `PUT /api/jobs/{id}` updates job configuration and schedule |
| 5 | `DELETE /api/jobs/{id}` soft-deletes job |
| 6 | `POST /api/jobs/{id}/run` triggers immediate execution |
| 7 | `POST /api/jobs/{id}/enable` enables disabled job |
| 8 | `POST /api/jobs/{id}/disable` disables job (stops scheduling) |
| 9 | `GET /api/jobs/{id}/executions` returns paginated execution history |
| 10 | `GET /api/jobs/{id}/executions/{exec_id}` returns execution details |

## Tasks / Subtasks

- [ ] Task 1: Create job repository and service
- [ ] Task 2: Create job API endpoints (AC: 1-5)
- [ ] Task 3: Implement run-now endpoint (AC: 6)
- [ ] Task 4: Implement enable/disable (AC: 7, 8)
- [ ] Task 5: Create execution history endpoints (AC: 9, 10)

## Dev Notes

### API Examples
```json
// POST /api/jobs
{
  "name": "Nightly Backup",
  "type": "policy_execution",
  "configuration": {"policy_id": "uuid"},
  "schedule_type": "cron",
  "schedule_config": {"expression": "0 2 * * *"}
}

// GET /api/jobs
[
  {
    "id": "uuid",
    "name": "Nightly Backup",
    "type": "policy_execution",
    "is_enabled": true,
    "next_run_at": "2026-01-18T02:00:00Z",
    "last_status": "success"
  }
]
```

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-17 | 0.1 | Initial story creation | PM (John) |

---

## Dev Agent Record

### Agent Model Used
### Debug Log References
### Completion Notes List
### File List

---

## QA Results
