# Story 2.4: Server List View

## Status: Draft

## Story

**As a** user,
**I want** to see all my SQL Server instances in a list,
**so that** I can quickly view and manage my server fleet.

## Acceptance Criteria

| # | Criteria |
|---|----------|
| 1 | Server list page at `/servers` route |
| 2 | Table columns: Name, Host/Instance, Status, Groups (tags), Version, Added Date |
| 3 | Status indicator: Online (green), Offline (red), Unknown (gray) |
| 4 | Search box filters by name, host, or group |
| 5 | Sortable columns (click header to sort) |
| 6 | Row click navigates to server detail page |
| 7 | Bulk select checkboxes for multi-server actions |
| 8 | "Add Server" button in header |
| 9 | Empty state with prompt to add first server |
| 10 | Pagination or virtual scroll for large lists (50+ servers) |

## Tasks / Subtasks

- [ ] Task 1: Create Servers page (AC: 1)
  - [ ] Create `src/pages/Servers.tsx`
  - [ ] Add route in App.tsx
  - [ ] Fetch servers with useQuery

- [ ] Task 2: Create server list table (AC: 2, 3, 5, 6)
  - [ ] Create `src/components/servers/ServerList.tsx`
  - [ ] Use shadcn Table component
  - [ ] Add status badge component
  - [ ] Implement column sorting
  - [ ] Add row click navigation

- [ ] Task 3: Add search and filter (AC: 4)
  - [ ] Create search input component
  - [ ] Filter table by name/host/group
  - [ ] Debounce search input

- [ ] Task 4: Add bulk selection (AC: 7)
  - [ ] Add checkbox column
  - [ ] Track selected rows
  - [ ] Add bulk action dropdown (future use)

- [ ] Task 5: Add header and empty state (AC: 8, 9)
  - [ ] Add page header with "Add Server" button
  - [ ] Create empty state component
  - [ ] Link to onboarding modal

- [ ] Task 6: Add pagination (AC: 10)
  - [ ] Implement client-side pagination
  - [ ] Show 20 rows per page
  - [ ] Add page navigation

## Dev Notes

### Server List Hook
```typescript
// src/hooks/useServers.ts
import { useQuery } from '@tanstack/react-query';
import { serverService } from '../services/serverService';

export function useServers() {
  return useQuery({
    queryKey: ['servers'],
    queryFn: serverService.getAll,
    staleTime: 30_000,
  });
}
```

### Status Badge Component
```typescript
// src/components/common/StatusBadge.tsx
const statusConfig = {
  online: { color: 'bg-green-500', label: 'Online' },
  offline: { color: 'bg-red-500', label: 'Offline' },
  unknown: { color: 'bg-gray-400', label: 'Unknown' },
  warning: { color: 'bg-yellow-500', label: 'Warning' },
};
```

### Table Sorting
```typescript
const [sortConfig, setSortConfig] = useState<{
  key: string;
  direction: 'asc' | 'desc';
} | null>(null);

const sortedServers = useMemo(() => {
  if (!sortConfig) return servers;
  return [...servers].sort((a, b) => {
    if (a[sortConfig.key] < b[sortConfig.key]) {
      return sortConfig.direction === 'asc' ? -1 : 1;
    }
    // ...
  });
}, [servers, sortConfig]);
```

## Testing

### Test Requirements
- Test server list renders correctly
- Test search filters results
- Test sorting works
- Test pagination
- Test empty state displays
- Location: `frontend/tests/pages/Servers.test.tsx`

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-17 | 0.1 | Initial story creation | PM (John) |

---

## Dev Agent Record

### Agent Model Used
(To be filled by dev agent)

### Debug Log References
(To be filled by dev agent)

### Completion Notes List
(To be filled by dev agent)

### File List
(To be filled by dev agent)

---

## QA Results
(To be filled by QA agent)
