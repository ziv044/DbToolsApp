# Story 2.7: Server Groups UI

## Status: Draft

## Story

**As a** user,
**I want** a UI to create and manage server groups,
**so that** I can organize my fleet logically.

## Acceptance Criteria

| # | Criteria |
|---|----------|
| 1 | Groups page at `/groups` route |
| 2 | Group list: Name, Description, Server Count, Actions |
| 3 | "Create Group" button opens modal: Name, Description fields |
| 4 | Click group row expands or navigates to group detail |
| 5 | Group detail shows member server list |
| 6 | "Add Servers" button opens server picker modal (multi-select) |
| 7 | Remove server from group with X button per row |
| 8 | Edit group name/description inline or via modal |
| 9 | Delete group with confirmation (warns about policy implications) |
| 10 | Empty state prompts to create first group |

## Tasks / Subtasks

- [ ] Task 1: Create Groups page (AC: 1, 10)
  - [ ] Create `src/pages/Groups.tsx`
  - [ ] Add route in App.tsx
  - [ ] Add empty state component

- [ ] Task 2: Create group list component (AC: 2, 4)
  - [ ] Create `src/components/groups/GroupList.tsx`
  - [ ] Display groups in cards or table
  - [ ] Show server count per group
  - [ ] Add click to navigate/expand

- [ ] Task 3: Create group form modal (AC: 3, 8)
  - [ ] Create `src/components/groups/GroupForm.tsx`
  - [ ] Add name and description fields
  - [ ] Support create and edit modes
  - [ ] Validate unique name

- [ ] Task 4: Create group detail view (AC: 5, 7)
  - [ ] Create `src/pages/GroupDetail.tsx` or expand view
  - [ ] List member servers
  - [ ] Add remove button per server

- [ ] Task 5: Create server picker (AC: 6)
  - [ ] Create `src/components/groups/ServerPicker.tsx`
  - [ ] Multi-select from available servers
  - [ ] Filter servers already in group
  - [ ] Submit adds selected to group

- [ ] Task 6: Add delete functionality (AC: 9)
  - [ ] Add delete button with confirmation
  - [ ] Show warning about policies
  - [ ] Refresh list after delete

## Dev Notes

### Group Hooks
```typescript
export function useGroups() {
  return useQuery({
    queryKey: ['groups'],
    queryFn: groupService.getAll,
  });
}

export function useGroup(id: string) {
  return useQuery({
    queryKey: ['groups', id],
    queryFn: () => groupService.getById(id),
    enabled: !!id,
  });
}

export function useAddServersToGroup() {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: ({ groupId, serverIds }) =>
      groupService.addServers(groupId, serverIds),
    onSuccess: (_, { groupId }) => {
      queryClient.invalidateQueries(['groups', groupId]);
    },
  });
}
```

### Group Service
```typescript
export const groupService = {
  getAll: async () => {
    const { data } = await apiClient.get('/groups');
    return data;
  },
  getById: async (id: string) => {
    const { data } = await apiClient.get(`/groups/${id}`);
    return data;
  },
  create: async (input: CreateGroupInput) => {
    const { data } = await apiClient.post('/groups', input);
    return data;
  },
  addServers: async (groupId: string, serverIds: string[]) => {
    const { data } = await apiClient.post(`/groups/${groupId}/servers`, { server_ids: serverIds });
    return data;
  },
  removeServer: async (groupId: string, serverId: string) => {
    await apiClient.delete(`/groups/${groupId}/servers/${serverId}`);
  },
};
```

## Testing

### Test Requirements
- Test group list displays correctly
- Test create group modal
- Test server picker multi-select
- Test remove server from group
- Location: `frontend/tests/pages/Groups.test.tsx`

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-17 | 0.1 | Initial story creation | PM (John) |

---

## Dev Agent Record

### Agent Model Used
(To be filled by dev agent)

### Debug Log References
(To be filled by dev agent)

### Completion Notes List
(To be filled by dev agent)

### File List
(To be filled by dev agent)

---

## QA Results
(To be filled by QA agent)
